<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>Title</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
	</head>
	<body>
		<TABLE cellSpacing="5" cellPadding="0" width="100%" border="0" height="100%">
			<TR>
				<TD valign="top" width="210" class="form">
					<p align="center">
						<A href="http://sourceforge.net"><IMG src="http://sourceforge.net/sflogo.php?group_id=104740&amp;type=5" width="210" height="62"
								border="0" alt="SourceForge.net Logo"></A>
					</p>
					<P style="LINE-HEIGHT: 25px">
						<A href="default.htm">Home</A><BR>
						<a href="http://sourceforge.net/projects/structuremap">StructureMap on SourceForge</a><br>
						<A href="Basic Architecture.htm">Basic Architecture</A><BR>
						<A href="Concepts.htm">Concepts</A><BR>
						<A href="StructureMap-API.chm">API Documentation</A><BR>
						<A href="FAQ.htm">FAQ</A><BR>
						<A href="Configuration.htm">Configuration Schema</A><BR>
						&nbsp;&nbsp;&nbsp; <a href="MementoSources.htm">Memento Sources</a><BR>
						&nbsp;&nbsp;&nbsp; <a href="NodeNormalized.htm">Node Normalized Xml</a><BR>
						&nbsp;&nbsp;&nbsp; <a href="AttributeNormalized.htm">Attribute 
						Normalized Xml</a><BR>
						&nbsp;&nbsp;&nbsp; <a href="Attributes.htm">Attribute Usage</a><BR>
						&nbsp;&nbsp;&nbsp; <a href="Scoping.htm">Instance Lifecyle Scoping</a><BR>
						
						<A href="ConfigurationManagement.htm">Configuration Management</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="StructureMapDoctor.htm">StructureMapDoctor</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="StructureMapExplorer.htm">StructureMapExplorer</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="structuremap.deployment.htm">deployment Task</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="structuremap.verification.htm">verification Task</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="ValidationAttribute.htm">ValidationMethod Attribute</A><BR>
						&nbsp;&nbsp;&nbsp; <A href="NAnt Tasks.htm">Other NAnt Tasks</A><BR>

						
						<A href="Troubleshooting.htm">Troubleshooting</A><BR>
						<A href="SingletonInjection.htm">Singleton Injection</A></P>

				</TD>
				<TD valign="top" style="PADDING-LEFT: 25px">
					<h1>Using and Configuring MementoSource's</h1>
					<p>For small applications the StructureMap.config file might 
					suffice for all configuration.&nbsp; In even a medium sized 
					project the StructureMap.config file gets too long to be 
					easily maintained.&nbsp; Fortunately, the configuration in StructureMap 
					is extensible to allow configuration storage in multiple 
					files or embedded resources.&nbsp; You can even create and 
					use <a href="#Extending">custom configuration sources</a>.&nbsp; 
					Each PluginFamily has a MementoSource object 
					to locate the instance configuration.&nbsp; The 
					MementoSource can be configured for a PluginFamily through 
					either the &lt;Source&gt; node in the StructureMap or by using the 
					optional [PluginFamily(Source=typeof(somesource))] [LINK]attribute 
					property.</p>
					<h3>Single External Xml File</h3>
					<p>Stores InstanceMemento's in an external Xml file.&nbsp; 
					The memento's are in the Node Normalized style.</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Implementation of XmlMementoSource that reads InstanceMemento's from an external file.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Useful to break the StructureMap.config file into smaller pieces.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [Pluggable("XmlFile", "")]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> XmlFileMementoSource : XmlMementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">string</span> _filePath;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">string</span> _xpath;</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Default constructor</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="FilePath"&gt;</span><span style="color: green;">Path to the xml file that contains the instance configuration</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="XPath"&gt;</span><span style="color: green;">XPath expression to the parent node that contains the InstanceMemento nodes.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> If empty, it defaults to the top node</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="NodeName"&gt;</span><span style="color: green;">The name of the nodes that are InstanceMemento nodes.&nbsp; Useful to store </span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> different types of instances in the same file</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [DefaultConstructor]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> XmlFileMementoSource(<span style="color: blue;">string</span> FilePath, <span style="color: blue;">string</span> XPath, <span style="color: blue;">string</span> NodeName)</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; : <span style="color: blue;">base</span>(NodeName, "Type", "Key", XmlMementoStyle.NodeNormalized)</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _filePath = FilePath;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _xpath = XPath;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre>
</div>


					<h4>Sample Configuration</h4>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">PluginFamily</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="StructureMap.Testing.Widget.IWidget"</span><span style="color: fuchsia;"> </span><span style="color: red;">Assembly</span><span style="color: blue;">="StructureMap.Testing.Widget"</span><span style="color: fuchsia;"> </span><span style="color: red;">DefaultKey</span><span style="color: blue;">="Red"&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Source</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="XmlFile"</span><span style="color: fuchsia;"> </span><span style="color: red;">FilePath</span><span style="color: blue;">="FullTesting.XML"</span><span style="color: fuchsia;"> </span><span style="color: red;">XPath</span><span style="color: blue;">="Widgets"</span><span style="color: fuchsia;"> </span><span style="color: red;">NodeName</span><span style="color: blue;">="Widget"/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Plugin</span><span style="color: fuchsia;"> </span><span style="color: red;">Assembly</span><span style="color: blue;">="StructureMap.Testing.Widget"</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="StructureMap.Testing.Widget.NotPluggableWidget"</span><span style="color: fuchsia;"> </span><span style="color: red;">ConcreteKey</span><span style="color: blue;">="NotPluggable"/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">PluginFamily</span><span style="color: blue;">&gt;</span></pre>
</div>
					<h3>Single Xml Memento per File</h3>
					<p>For deeper object graphs or large number of instances of 
					the same PluginType it might be advantageous to put each 
					configured instance into it's own file.&nbsp; Finds an 
					InstanceMemento by looking in the folder path 
					[directory]\[Instance Key].[extension]</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [Pluggable("DirectoryXml")]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> DirectoryXmlMementoSource : MementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> <span style="color: blue;">string</span> _directory;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> <span style="color: blue;">string</span> _extension;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> XmlMementoCreator _mementoCreator;</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Stores an Xml InstanceMemento per file in a directory</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="directory"&gt;</span><span style="color: green;">A ";" delimited list of directories to look for mementos.&nbsp; DirectoryXmlMementoSource </span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> will use the FIRST directory it finds</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="extension"&gt;</span><span style="color: green;">The file extension of the InstanceMemento files without a dot.&nbsp; Typically "xml"</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="mementoStyle"&gt;</span><span style="color: green;">NodeNormalized or AttributeNormalized</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> DirectoryXmlMementoSource(<span style="color: blue;">string</span> directory, <span style="color: blue;">string</span> extension, XmlMementoStyle mementoStyle) : <span style="color: blue;">base</span>()</pre>
</div>
<h4>Sample Configuration</h4>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">PluginFamily</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="StructureMap.Testing.Widget.IWidget"</span><span style="color: fuchsia;"> </span><span style="color: red;">Assembly</span><span style="color: blue;">="StructureMap.Testing.Widget"</span><span style="color: fuchsia;"> </span><span style="color: red;">DefaultKey</span><span style="color: blue;">="Red"&gt;</span></pre>
<pre style="margin: 0px;">        <span style="color: blue;">&lt;</span><span style="color: maroon;">Source</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">=&quot;DirectoryXml&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">directory</span><span style="color: blue;">=&quot;Widgets;..\..\Widgets;D:\WidgetService\Widgets&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">extension</span><span style="color: blue;">=&quot;xml&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">mementoStyle</span><span style="color: blue;">=&quot;AttributeNormalized&quot;/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">PluginFamily</span><span style="color: blue;">&gt;</span></pre>
</div>

<h3>Single Embedded Xml File</h3>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [Pluggable("EmbeddedXmlFile")]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> SingleEmbeddedXmlMementoSource : XmlMementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> <span style="color: blue;">string</span> _path;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> Assembly _assembly;</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Retrieves Xml InstanceMemento's from an xml file stored as an embedded resource in an assembly.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="nodeName"&gt;</span><span style="color: green;">Designates the nodes that are memento nodes</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="style"&gt;</span><span style="color: green;">NodeNormalized or AttributeNormalized</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="assemblyName"&gt;</span><span style="color: green;">The name of the Assembly the file is embedded into</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="path"&gt;</span><span style="color: green;">The path to the embedded resource within the file</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [DefaultConstructor]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> SingleEmbeddedXmlMementoSource(<span style="color: blue;">string</span> nodeName, XmlMementoStyle style, <span style="color: blue;">string</span> assemblyName, <span style="color: blue;">string</span> path)</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; : <span style="color: blue;">base</span>(nodeName, "Type", "Key", style)</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _path = path;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _assembly = Assembly.Load(assemblyName);</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre>
</div>

<h4>Sample Configuration</h4>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">PluginFamily</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="StructureMap.Testing.Widget.IWidget"</span><span style="color: fuchsia;"> </span><span style="color: red;">Assembly</span><span style="color: blue;">="StructureMap.Testing.Widget"</span><span style="color: fuchsia;"> </span><span style="color: red;">DefaultKey</span><span style="color: blue;">="Red"&gt;</span></pre>
<pre style="margin: 0px;">        <span style="color: blue;">&lt;</span><span style="color: maroon;">Source Type=&quot;EmbeddedXmlFile&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">nodeName</span><span style="color: blue;">=&quot;Widget&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">assemblyName</span><span style="color: blue;">=&quot;StructureMap.Testing&quot;</span><span style="color: fuchsia;"> path=&quot;StructureMap.Testing.TestData.Widgets.xml&quot; </span><span style="color: #FF0000">style</span><span style="color: blue;">=&quot;AttributeNormalized&quot;/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">PluginFamily</span><span style="color: blue;">&gt;</span></pre>
</div>

<h3>Single Xml Memento per Embedded File</h3>
<p>Stores InstanceMemento Xml files in a directory of embedded resources.&nbsp; 
Finds an embedded resource by the pattern [folderPath].[Instance 
Key].[extension]</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [Pluggable("EmbeddedXmlFolder")]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> EmbeddedFolderXmlMementoSource : MementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Implementation of MementoSource that stores and retrieves an XmlInstanceMemento per Embedded Resource file </span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> in a named namespace.&nbsp; EmbeddedFolderXmlMementoSource is meant to simplify complicated object graph configurations </span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> by isolating each instance to a separate</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> editable file.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="style"&gt;</span><span style="color: green;">NodeNormalized or AttributeNormalized</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="assemblyName"&gt;</span><span style="color: green;">The name of the Assembly with the embedded resources</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="folderPath"&gt;</span><span style="color: green;">The root namespace of all of the mementos.</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="extension"&gt;</span><span style="color: green;">The file extension of the memento files - "xml"</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [DefaultConstructor]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> EmbeddedFolderXmlMementoSource(XmlMementoStyle style, <span style="color: blue;">string</span> assemblyName, <span style="color: blue;">string</span> folderPath, <span style="color: blue;">string</span> extension)</pre>
</div>
<h4>Sample Configuration</h4>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">PluginFamily</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="StructureMap.Testing.Widget.IWidget"</span><span style="color: fuchsia;"> </span><span style="color: red;">Assembly</span><span style="color: blue;">="StructureMap.Testing.Widget"</span><span style="color: fuchsia;"> </span><span style="color: red;">DefaultKey</span><span style="color: blue;">="Red"&gt;</span></pre>
<pre style="margin: 0px;">        <span style="color: blue;">&lt;</span><span style="color: maroon;">Source Type=&quot;EmbeddedXmlFolder&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">style=&quot;AttributeNormalized&quot;</span><span style="color: fuchsia;"> </span><span style="color: #FF0000">assemblyName</span><span style="color: blue;">=&quot;StructureMap.Testing&quot;</span><span style="color: fuchsia;"> path=&quot;StructureMap.Testing.TestData.Widgets&quot; </span><span style="color: blue;">extension=&quot;xml&quot;/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">PluginFamily</span><span style="color: blue;">&gt;</span></pre>
</div>
<h3><a name="Templated"></a>Templated Mementos</h3>
<p>In a case </p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [Pluggable("Templated")]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> TemplatedMementoSource : MementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> MementoSource _innerSource;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> MementoSource _templateSource;</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Default Constructor</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="innerSource"&gt;</span><span style="color: green;">MementoSource that contains the Memento Templates</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="templateSource"&gt;</span><span style="color: green;">MementoSource that contains instances consisting of Template valuee</span><span style="color: gray;">&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> TemplatedMementoSource(MementoSource innerSource, MementoSource templateSource)</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _innerSource = innerSource;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _templateSource = templateSource;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre>
</div>
<p>Consider this InstanceMemento below.&nbsp; It describes a validation rule on 
an invoicing data structure that invalidates a date that is in the past.&nbsp; 
The rule itself can be applied to any combination of date field at either the 
invoice header or invoice detail level and error severity (reject the invoice or 
just warn).&nbsp; Rather than write a separate InstanceMemento file for each 
possible permutation we extended StructureMap to allow for a &quot;templated&quot; memento 
source that would allow us to simply fill in the blanks in a larger 
InstanceMemento source.&nbsp; Note the &quot;{FieldName}&quot; values in the xml.&nbsp; In 
a similar manner to NAnt, the TemplateMementoSource will substitute in values 
into the xml configuration just prior to hydrating the instance.</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;"><span style="color: blue;">&lt;?</span><span style="color: maroon;">xml</span><span style="color: fuchsia;"> </span><span style="color: red;">version</span><span style="color: blue;">="1.0"</span><span style="color: fuchsia;"> </span><span style="color: red;">encoding</span><span style="color: blue;">="utf-8"</span><span style="color: fuchsia;"> </span><span style="color: blue;">?&gt;</span> </pre>
<pre style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">Rule</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Default"</span><span style="color: fuchsia;"> </span><span style="color: red;">ruleName</span><span style="color: blue;">="{FieldName} is post dated."&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">actions</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Child</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Error"</span><span style="color: fuchsia;"> </span><span style="color: red;">subjectField</span><span style="color: blue;">="{FieldName}"</span><span style="color: fuchsia;"> </span><span style="color: red;">severity</span><span style="color: blue;">="{Severity}"</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">message</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Message"</span><span style="color: fuchsia;"> </span><span style="color: red;">template</span><span style="color: blue;">=" {FieldName} [{FieldName}] is post dated"/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">Child</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">actions</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">query</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="DataSetQuery"</span><span style="color: fuchsia;"> </span><span style="color: red;">scope</span><span style="color: blue;">="{Scope}"&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">filters</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Child</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Aged"</span><span style="color: fuchsia;"> </span><span style="color: red;">fieldName</span><span style="color: blue;">="{FieldName}"</span><span style="color: fuchsia;"> </span><span style="color: red;">count</span><span style="color: blue;">="0"</span><span style="color: fuchsia;"> </span><span style="color: red;">durationUnit</span><span style="color: blue;">="Days"</span><span style="color: fuchsia;"> </span><span style="color: blue;">/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">filters</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">exceptions</span><span style="color: fuchsia;"> </span><span style="color: blue;">/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">query</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: maroon;">Rule</span><span style="color: blue;">&gt;</span></pre>
</div>
<p>The actual memento for a user's rules would look something like this for the post date constraint rule:</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;"><span style="color: blue;">&lt;!</span><span style="color: green;">-- The Template attribute refers to the instance template --</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">Instance</span><span style="color: fuchsia;"> </span><span style="color: red;">Template</span><span style="color: blue;">="PostDateConstraint"</span><span style="color: fuchsia;"> </span><span style="color: red;">FieldName</span><span style="color: blue;">="InvoiceDate"</span><span style="color: fuchsia;"> </span><span style="color: red;">Scope</span><span style="color: blue;">="Invoice"</span><span style="color: fuchsia;"> </span><span style="color: red;">Severity</span><span style="color: blue;">="Error"</span><span style="color: fuchsia;"> </span><span style="color: blue;">/&gt;</span></pre>
</div>

<p>At runtime StructureMap will substitute the values from the InstanceMemento above into the template to create this:</p>

<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;"><span style="color: blue;">&lt;?</span><span style="color: maroon;">xml</span><span style="color: fuchsia;"> </span><span style="color: red;">version</span><span style="color: blue;">="1.0"</span><span style="color: fuchsia;"> </span><span style="color: red;">encoding</span><span style="color: blue;">="utf-8"</span><span style="color: fuchsia;"> </span><span style="color: blue;">?&gt;</span> </pre>
<pre style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">Rule</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Default"</span><span style="color: fuchsia;"> </span><span style="color: red;">ruleName</span><span style="color: blue;">=&quot;InvoiceDate is post dated."&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">actions</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Child</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Error"</span><span style="color: fuchsia;"> </span><span style="color: red;">subjectField</span><span style="color: blue;">=&quot;InvoiceDate"</span><span style="color: fuchsia;"> </span><span style="color: red;">severity</span><span style="color: blue;">=&quot;Error"</span><span style="color: fuchsia;"> </span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">message</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Message"</span><span style="color: fuchsia;"> </span><span style="color: red;">template</span><span style="color: blue;">=" InvoiceDate [InvoiceDate] is post dated"/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">Child</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">actions</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">query</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="DataSetQuery"</span><span style="color: fuchsia;"> </span><span style="color: red;">scope</span><span style="color: blue;">=&quot;Invoice"&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">filters</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">Child</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Aged"</span><span style="color: fuchsia;"> </span><span style="color: red;">fieldName</span><span style="color: blue;">=&quot;InvoiceDate"</span><span style="color: fuchsia;"> </span><span style="color: red;">count</span><span style="color: blue;">="0"</span><span style="color: fuchsia;"> </span><span style="color: red;">durationUnit</span><span style="color: blue;">="Days"</span><span style="color: fuchsia;"> </span><span style="color: blue;">/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">filters</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">exceptions</span><span style="color: fuchsia;"> </span><span style="color: blue;">/&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">query</span><span style="color: blue;">&gt;</span></pre>
<pre style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: maroon;">Rule</span><span style="color: blue;">&gt;</span></pre>
</div>
<p>StructureMap looks for attribute values that begin and end with {} to determine the tokens to replace.  This behavior can be overriden by using a Substitutions 
attribute to specify a comma-delimited list of substitutions</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">Rule</span><span style="color: fuchsia;"> </span><span style="color: red;">Type</span><span style="color: blue;">="Default"</span><span style="color: fuchsia;"> </span><span style="color: red;">ruleName</span><span style="color: blue;">="Condition on {FieldName} {Operator} {ComparisonValue}"</span><span style="color: fuchsia;"> </span></pre>
<pre style="margin: 0px;"><span style="color: fuchsia;">&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Substitutions</span><span style="color: blue;">="FieldName,Scope,Operator,ComparisonValue,Severity,AlternativeMessage"&gt;</span></pre>
</div>

					<h3><a name="Extending"></a>Creating a new MementoSource</h3>
					<p>StructureMap can be extended to add new types of configuration storage.  Simply create a subclass of MementoSource and override these methods:</p>
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white; border-top: windowtext 1pt solid; padding-top: 0pt; border-left: windowtext 1pt solid; padding-left: 0pt; border-right: windowtext 1pt solid; padding-right: 0pt; border-bottom: windowtext 1pt solid; padding-bottom: 0pt;">
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Abstract class that is the supertype of all storage and retrieval mechanisms of</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> InstanceMemento instances</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; [PluginFamily]</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">abstract</span> <span style="color: blue;">class</span> MementoSource</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> PluginFamily _family;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> InstanceMemento _defaultMemento;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> Hashtable _externalMementos = <span style="color: blue;">new</span> Hashtable();</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> MementoSource() : <span style="color: blue;">base</span>()</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Retrieves an array of all InstanceMemento's stored by this MementoSource</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;returns&gt;&lt;/returns&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> <span style="color: blue;">abstract</span> InstanceMemento[] fetchInternalMementos();</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Template pattern method.&nbsp; Determines if the MementoSource contains a definition for the</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> requested instanceKey.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="instanceKey"&gt;&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;returns&gt;&lt;/returns&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> <span style="color: blue;">internal</span> <span style="color: blue;">abstract</span> <span style="color: blue;">bool</span> containsKey(<span style="color: blue;">string</span> instanceKey);</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> Retrieves an InstanceMemento for the instanceKey</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;param name="instanceKey"&gt;&lt;/param&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;returns&gt;&lt;/returns&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> <span style="color: blue;">abstract</span> InstanceMemento retrieveMemento(<span style="color: blue;">string</span> instanceKey);</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> String description of the MementoSource.&nbsp; Used in the StructureMap-Client UI.</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: gray;">///</span><span style="color: green;"> </span><span style="color: gray;">&lt;/summary&gt;</span></pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">abstract</span> <span style="color: blue;">string</span> Description { <span style="color: blue;">get</span>; }</pre>
<pre style="margin: 0px;">&nbsp;</pre>
<pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre>
</div>
				</TD>
			</TR>
		</TABLE>
	</body>
</html>